\documentclass{llncs}

\usepackage[latin1]{inputenc}
\usepackage[french]{babel}
\usepackage{url}
\usepackage{graphicx}
%\usepackage{alltt}

\newcommand{\ocaml}{O'Caml}
\newcommand{\ocamlgraph}{Ocamlgraph}
\newcommand{\graphviz}{Graphviz}
\newcommand{\miquel}{A. Miquel}
\newcommand{\noeud}{n\oe ud}
\newcommand{\noeuds}{n\oe uds}


\begin{document}

\title{Édition interactive de graphes\\ en géométrie hyperbolique}

\author{Benjamin Vadon}

\institute{Stage de TER 2006--2007 \\
effectué sous la direction de Jean-Christophe Filliâtre \\
à l'INRIA Futurs, dans l'équipe ProVal \\
Parc Club Université, 91893 ORSAY}

\maketitle

\section{Introduction}
Nous nous intéressons à la visualisation et à l'édition de graphes.
La visualisation d'un graphe comportant peu de \noeuds\ et d'arêtes est
un problème trivial, mais le sujet se complique très rapidement dès
que le nombre de ces composants augmente.
En effet, la représentation d'un graphe pose un problème dès qu'il
commence à être d'une taille conséquente, et notamment quand le 
nombre d'arêtes est relativement élevé en proportion du nombre de
\noeuds\ : les arêtes se croisent ce qui est à même de gêner la
compréhension.

Bien des gens se sont penchés sur ce thème et un grand nombre
d'algorithmes de placement dans le plan en ont résulté. On peut citer
\graphviz~\cite{graphviz} comme suite logicielle très connue dans le
domaine de la visualisation planaire de graphes qui applique un certain
nombre de ces algorithmes.
Ce problème a aussi été abordé d'une manière différente, en tentant de
réaliser une représentation de graphe dans l'espace. Certes, avec
cette méthode on peut arriver à ce que les arêtes ne s'entrecroisent
pas, mais cela ne répond pas tout à fait au problème d'amélioration de
lisibilité du graphe, car un graphe contenant beaucoup d'éléments
restera indéchiffrable, même en 3d.

L'objectif de ce stage est de se pencher sur ce sujet mais en
l'abordant d'une façon encore différente, et ce en utilisant une
représentation planaire, mais dans le plan hyperbolique de Poincaré
contrairement au plan Euclidien couramment utilisé.
Le point de départ de ce TER est le travail effectué par
\miquel~\cite{miquel} sur la représentation d'arbres à l'aide de la
géométrie hyperbolique. 
Nous allons tout d'abord expliquer les grands principes de la géométrie
hyperbolique, et plus particulièrement dans le plan hyperbolique de
Poincaré.
Ensuite, nous ferons le lien entre cette géométrie non euclidienne et
son application à la représentation de graphes, par le biais du
travail de \miquel.
Et enfin, nous nous pencherons sur sa réalisation en \ocaml\ dans le
cadre de la librairie \ocamlgraph, servant à la fois de support de
développement et de médium de diffusion.


\section{Géométrie hyperbolique}

\subsection{Principe}

La géométrie euclidienne est fondée sur cinq postulats dictés par Euclide
dans ses ``Éléments''. Le cinquième postulat, pouvant être formulé comme ceci
\begin{quote}
``Étant donnés une droite $D$ et un point M, il n'existe qu'une seule
droite passant par $M$ et qui soit parallèle à $D$.''
\end{quote} 
a été remis en question dès la renaissance, et c'est
environ en 1850 que Bolyai et Lobatchevsky ont indépendamment
découvert une nouvelle géométrie vérifiant les quatre premiers axiomes
d'Euclide, mais réfutant le postulat des parallèles. Certains principes de
la géométrie euclidienne sont conservés, tels que :
\begin{itemize}
\item  une droite est le chemin le plus court reliant deux points ;
\item  deux droites sont parallèles si elles ne s'intersectent pas.
\end{itemize}
Cette géométrie dite hyperbolique est donc
basée sur le fait qu'en un point $M$, il peut passer une infinité de
droites parallèles à la droite $D$. Ainsi exprimé, ce concept peut
paraître difficile à imaginer, mais plusieurs modèles permettant de se
représenter la géométrie hyperbolique ont été développé depuis sa
découverte. En prenant le schéma suivant, relativement simple, basé
sur un de ces modèles, on pourra mieux se représenter le fait d'avoir
plusieurs parallèles passant par un même point. En effet, on peut voir
que les trois droites $d_1$, $d_2$ et $d_3$ passent par $M$ et sont parallèles à
$D$ (et non parallèles entre elles car elles se croisent en $M$). Précisons
que dans cette géométrie, les droites nous apparaissent courbes, mais
ce sont bien des droites au sens où elles représentent le plus court
chemin entre deux points.

\begin{center}
\includegraphics[scale=0.50]{parallels.eps}
\end{center}
 
Henri Poincaré a imaginé un modèle pour la géométrie hyperbolique que
l'on appelle le disque de Poincaré. Ce modèle est composé d'un cercle $C$,
dénomé horizon, et d'un ensemble de point se trouvant à l'intérieur
strict de ce cercle. Les points de l'horizon sont dits idéaux pour le modèle.
Pour essayer de faciliter la compréhension de ce modèle, on peut se
pencher sur la figure de gauche ci-après qui représente le plan euclidien sur
lequel on a déposé une lentille plan convexe convergente (semblable à
un bol transparent rempli d'eau), et dont la surface plane est notre
disque de Poincaré. On peut voir que pour représenter un
point sur ce plan, on trace une droite $D$ entre le centre du
disque unité et le point dans le plan euclidien, et ensuite on prend
la normal $N$ au plan hyperbolique où $D$ à traversé la lentille. Les
droites sont représentées par des arcs portés par des cercles
perpendiculaires à $C$ comme illustré par la droite $D_3$ ci-après, sur la figure de
droite.  
\begin{center}
image de la lentille 
% \includegraphics[scale=0.25]{lentille.eps}   
\end{center}
\begin{center}
  \includegraphics[scale=0.25]{perpendiculaire.eps}  
\end{center}

On peut noter que les droites $D_2$ et $D_3$ sont parallèles à $D_1$, mais,
étant donné qu'elles se coupent, $D_2$ et $D_3$ ne sont pas parallèles entre
elles. Remarquons aussi que la droite $D_1$ est portée par un cercle
de rayon infini ce qui fait d'elle un diamètre du cercle $C$.

Ce modèle est doté d'une fonction $\delta$  que l'on
appelle une métrique, permettant de calculer la distance entre deux
points $A$ et $B$ du disque de Poincaré, dont la formule est la
suivante :  
$$
\delta(A,B) = \mathrm{ath}\left(\left|\frac{A-B}{1-\overline{A}B}\right|\right)
\quad\mbox{où}~
\mathrm{ath}(x) = \frac{1}{2}\ln\left(\frac{1+x}{1-x}\right)
$$

On remarque que si l'un des point, $A$ ou $B$, se
rapproche fortement du bord $C$ du disque, alors la distance
$\delta(A,B)$ tend vers l'infini. Pour bien comprendre ce
principe, qui nous sera fort important dans notre application de ce
modèle à la représentation des graphes, on peut imaginer que nous
observons un petit être vivant sur ce plan hyperbolique et qui se déplace dessus. À chaque pas qu'il fait dans la direction
de l'horizon (le bord du disque pour l'observateur), la distance par
unité de pas qu'il parcourt paraît de plus en plus petite pour
l'observateur. Ainsi le bord du disque est inatteignable pour ce petit
être vivant sur le plan de Poincaré. 

C'est en utilisant ce point de vue que nous avons réalisé le traçage
des segments de droites dans le plan hyperbolique, en implantant une
tortue LOGO se déplaçant sur ce plan.

\subsection{Tortue hyperbolique}

Ce principe de tortue LOGO, emprunté à \miquel, rend bien plus aisé la
compréhension de la géométrie hyperbolique. Il faut clairement
comprendre que nous aurons deux mondes :

\begin{itemize}
\item  le point de vue de l'observateur qui voit un disque unité, par
définition un espace borné, sur le lequel se déplace la tortue ;
\item le point de vue de la tortue qui se déplace dans le plan 
hyperbolique, par définition un espace infini.
\end{itemize}

Une tortue est définie par un type turtle composé d'une position et
d'une direction. 
\begin{center}
\texttt{type turtle = 
\{ 
  pos : coord; 
  dir : coord; 
\}
}
\end{center}
Elle peut avancer et tourner, à gauche  et à droite, tout comme son
équivalente en géométrie euclidienne. Bien entendu, pour représenter
ce déplacement, il nous faut des fonctions pour connaître la position
et la direction après un pas de mouvement. Ces foncions sont détaillés
dans \cite{miquel}. Les fonctions de déplacement et de rotations sont les suivantes :
\begin{itemize}
\item
\texttt{val advance : turtle -> float -> turtle = <fun>}
\item
\texttt{val turn\_left : turtle -> float -> turtle = <fun>}
\item
\texttt{val turn\_right : turtle -> float -> turtle = <fun>}
\end{itemize}

Sur la figure suivante, on peut voir le parcours de différentes
tortues se déplaçant sur le plan de Poincaré. On peut observer, entre
deux pas de temps identiques, la différence de distance parcourue qui
apparaît à l'observateur. 

\begin{center}
une image est à insérer, qui représente le parcours de différentes
tortues sur le plan hyperbolique
 % \includegraphics[scale=0.30]{parcours.eps}  
\end{center}

Nous avons maintenant un moyen de tracer facilement des droites sur le
plan hyperbolique, et nous pouvons nous intéresser au dessin d'un
graphe sur ce plan.

\section{Visualisation de graphes en géométrie hyperbolique}

\subsection{Visualisation d'arbres en géométrie hyperbolique}

Nous nous intéressons d'abord au travail effectué par
\miquel~\cite{miquel} sur les arbres qui sont un cas particulier, et
simplifié, de graphes ayant une seule source et aucun cycle. Le
problème est bien-sûr de placer correctement les \noeuds\ et ensuite le
traçage des arêtes est relativement trivial avec l'aide de notre
tortue et de ses fonctions de mouvement.

Pour répartir les \noeuds\ d'un arbre dans le plan hyperbolique, il se
base sur deux propriétés de ce plan :
\begin{itemize}
\item une droite du plan le sépare en deux demi-plans, tout comme en
  géométrie euclidienne ;
\item quelque soit $n$, on peut disposer de $n$ demi-plans deux à deux
  disjoints, contrairement à la géométrie euclidienne.
\end{itemize}

Pour arriver à répartir l'espace en $n$ demi-plans. \miquel\ illustre
le problème par le paradoxe des $n$ dictateurs. Le principe en est
simple : dans un espace fini à deux dimensions, $n$ dictateurs situés en
un même point désirent se partager le monde de façon à régner chacun
sur un demi-espace. Pour ce faire, ils se mettent en marche dans n
directions régulièrement espacées de $\frac{360}{n}$
degrés. Lorsqu'ils ont tous parcouru une distance $d$, les $n$ dictateurs
s'arrêtent, et chacun d'entre eux s'approprie le demi-espace en face
de lui (et dont la frontière est une droite imaginaire passant par
ses deux pieds).

 Dans le plan hyperbolique, quel que soit $n$, il existe une distance $d$
 à partir de laquelle les demi-espaces attribués aux dictateurs sont
 deux à deux disjoints. Pour calculer cette distance $d$, \miquel\ utilise la
 formule suivante :
$$
d_n= \mathrm{ath}\left(\mathrm{tan}\left(\frac{\pi}{4}-\frac{\pi}{2n}\right)\right)
$$ 
Donc pour le placement des \noeuds, il pose la racine au centre du
disque, sépare l'espace en $n$ demi-plans, où $n$ est le nombre de fils de
la racine, et enfin fait avancer la tortue de chaque fils suivant la
direction et la distance données. Ensuite, il fait de même
récursivement pour l'ensemble des successeurs de ces \noeuds.

Après avoir déterminer où placer les \noeuds\ d'un arbre, on peut
s'intéresser au placement des \noeuds\ d'un graphe qui pose certains
problèmes comme, par exemple, le fait que des arêtes peuvent se croiser.

\subsection{Adaptation aux graphes}

Le graphe diffère sur deux points importants, pour notre sujet, par
rapport à un arbre :
\begin{itemize}
\item il n'y a pas de racine, ce qui implique un choix arbitraire pour
  commencer le tracé ;
\item il peut, avec une forte certitude, y avoir des arêtes qui
  s'entrecroisent. 
\end{itemize}

Pour le choix de la racine, le choix est reporté sur la librairie
\ocamlgraph\ sous la forme d'une fonction donnant un n\oe ud
arbitraire.
À partir de cette racine, on procède comme pour l'affichage d'un
arbre, mais avec deux différences importantes :
\begin{itemize}
\item des \noeuds\ peuvent avoir été déjà dessinés auparavant, et donc
  il ne faut plus les considérés de la même manière, du point de vue
  affichage
\item des arêtes supplémentaires seront probablement nécessaire pour
  effectués les liens transversaux
\end{itemize}

Ces deux dissemblances peuvent avoir des conséquences importantes pour
l'affichage d'un graphe. D'une part, suivant le parcours de graphe
effectué, un \noeud aura été visité plus ou moins tôt. D'autre part,
l'ordonnancement des successeurs d'un noeud, rapproche ou éloigne
certains \noeuds reliés par une arête. 

\subsection{Heuristiques de placement}

Pour parcourir un graphe, on a  deux grands classiques, dans ce
domaine, envisageables que sont les parcours en largeur et en
profondeur, respectivement ci-après Bfs et Dfs. Nous avons implanté les deux, ce qui a permis de voir les
conséquences d'un tel choix. En observant les deux figures suivantes, il est
clairement visible que le choix entre les deux n'est pas évident.
Le Dfs semble moins croiser les arêtes. Le Bfs équilibre bien mieux la
représentation du graphe.
Pour choisir un parcours par défaut, nous avons préféré nous appuyer
sur quelque chose de sur plutot qu'une chose possible. En effet, dans
ce cas, le Dfs croise moins les arêtes, mais qu'en serait-il dans
d'autres; alors que dans tous les cas, le Bfs équilibrera mieux le
graphe.
Le choix s'est donc objectivement porté sur le parcours Bfs qui
permet de voir plus de \noeuds d'un seul coup.

Pour palier les défauts de placement engendrés par le Bfs, on a décidé
d'ordonnancer les successeurs d'un \noeud de manière à se faire
croiser le moins d'arêtes possible. L'idée de cet ordonnancement est
basé sur le fait que les successeurs ayant le moins d'arêtes ``extérieures''
posent le moins de problèmes. Donc, ordonner la liste des
successeurs d'un \noeud reviens à mettre en tête de liste
les \noeuds ayant le plus petit degré, et ainsi de suite jusqu'au
\noeud ayant le plus grand degré. 

\section{Réalisation dans \ocamlgraph}

\cite{ocaml} \cite{ocamlgraph}

\section{Conclusion}

\bibliographystyle{plain}
\bibliography{./biblio}

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
